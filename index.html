<!DOCTYPE html>
<html>
<head>
	<title>分页展示示例</title>
	<meta charset="UTF-8">
	<style>
		/* 样式省略，可以根据需要自行添加 */
	</style>
</head>
<body>
	<h1>分页展示示例</h1>
	<input type="text" id="searchInput" placeholder="搜索...">
	<button id="searchButton">搜索</button>
	<div id="tableContainer"></div>

	<script>
		// 读取数据文件
		fetch('data.txt')
			.then(response => response.text())
			.then(data => {
				// 将数据解析为对象数组
				const items = data.trim().split('\n').map(line => {
					const [id, name, type, msg] = line.replace(/[{}]/g, '').split(',');
					return { id, name, type, msg };
				});

				// 设置每页显示的数量
				const pageSize = 300;

				// 初始化分页和搜索
				let currentPage = 1;
				const totalPages = Math.ceil(items.length / pageSize);
				const tableContainer = document.getElementById('tableContainer');
				const searchInput = document.getElementById('searchInput');
				const searchButton = document.getElementById('searchButton');
				renderTable();

				// 渲染表格
				function renderTable() {
					// 清空容器
					tableContainer.innerHTML = '';

					// 创建表格元素
					const table = document.createElement('table');
					table.classList.add('table');

					// 创建表头
					const thead = document.createElement('thead');
					const tr = document.createElement('tr');
					const th1 = document.createElement('th');
					const th2 = document.createElement('th');
					th1.textContent = '图标';
					th2.textContent = '名称';
					tr.appendChild(th1);
					tr.appendChild(th2);
					thead.appendChild(tr);
					table.appendChild(thead);

					// 创建表格内容
					const tbody = document.createElement('tbody');
					const startIndex = (currentPage - 1) * pageSize;
					const endIndex = Math.min(startIndex + pageSize, items.length);
					for (let i = startIndex; i < endIndex; i++) {
						const item = items[i];
						const tr = document.createElement('tr');
						const td1 = document.createElement('td');
						const td2 = document.createElement('td');
						const img = document.createElement('img');
						img.src = 'ico/${item.id}.png';
						td1.appendChild(img);
						td2.textContent = item.name;
						tr.appendChild(td1);
						tr.appendChild(td2);
						tr.addEventListener('click', () => {
							// 点击行时显示详情
							alert('ID: ${item.id}\nType: ${item.type}\nMessage: ${item.msg}');
						});
						tbody.appendChild(tr);
					}
					table.appendChild(tbody);

					// 创建分页控件
					const pagination = document.createElement('div');
					pagination.classList.add('pagination');
					if (currentPage > 1) {
						const prevButton = document.createElement('button');
						prevButton.textContent = '上一页';
						prevButton.addEventListener('click', () => {
							currentPage--;
							renderTable();
						});
						pagination.appendChild(prevButton);
					}
					if (currentPage < totalPages) {
						const nextButton = document.createElement('button');
						nextButton.textContent = '下一页';
						nextButton.addEventListener('click', () => {
							currentPage++;
							renderTable();
						});
						pagination.appendChild(nextButton);
					}
					tableContainer.appendChild(table);
					tableContainer.appendChild(pagination);
				}

				// 搜索功能
				searchButton.addEventListener('click', () => {
					const keyword = searchInput.value.trim().toLowerCase();
					if (keyword) {
						const filteredItems = items.filter(item => item.name.toLowerCase().includes(keyword));
						if (filteredItems.length > 0) {
							currentPage = 1;
							renderTable();
						} else {
							alert('没有找到匹配项。');
						}
					}
				});
			})
			.catch(error => {
				console.error(error);
				alert('读取数据文件时发生错误。');
			});
	</script>
</body>
</html>