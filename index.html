<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>分页展示项</title>
  <style>
    /* 样式 */
    .item {
      display: inline-block;
      width: 150px;
      height: 150px;
      margin: 10px;
      text-align: center;
      vertical-align: top;
      cursor: pointer;
    }

    .item img {
      max-width: 100%;
      max-height: 100%;
    }

    /* 分页样式 */
    .pagination {
      text-align: center;
      margin-top: 20px;
    }

    .pagination a {
      display: inline-block;
      padding: 5px 10px;
      margin-right: 10px;
      background-color: #eee;
      color: #333;
      text-decoration: none;
    }

    .pagination a.active {
      background-color: #333;
      color: #fff;
    }
  </style>
</head>
<body>
  <!-- 搜索框 -->
  <input type="text" id="search" placeholder="搜索名称">
  <!-- 展示区域 -->
  <div id="items"></div>
  <!-- 分页 -->
  <div class="pagination"></div>

  <script>
    // 读取数据文件
    fetch('data.txt')
      .then(response => response.text())
      .then(text => {
        // 解析数据
        const items = text.split(',\n').map(item => {
          const match = item.match(/\{id:(\d+),name:'([^']*)',type:(\d+),msg:'([^']*)'\}/);
          if (match) {
            return {
              id: match[1],
              name: match[2],
              type: match[3],
              msg: match[4]
            };
          }
        }).filter(item => item !== undefined);

        // 创建项的HTML
        function createItemHTML(item) {
          return `
            <div class="item" data-id="${item.id}">
              <img src="ico/${item.id}.png" alt="${item.name}">
              <div>${item.name}</div>
            </div>
          `;
        }

        // 显示项
        function showItems(pageNumber) {
          const itemsDiv = document.getElementById('items');
          itemsDiv.innerHTML = '';

          const startIndex = (pageNumber - 1) * 1000;
          const endIndex = startIndex + 1000;
          const itemsToShow = items.slice(startIndex, endIndex);

          itemsToShow.forEach(item => {
            const itemHTML = createItemHTML(item);
            itemsDiv.insertAdjacentHTML('beforeend', itemHTML);
          });
        }

        // 显示分页
        function showPagination(pageNumber) {
          const paginationDiv = document.querySelector('.pagination');
          paginationDiv.innerHTML = '';

          const pageCount = Math.ceil(items.length / 1000);
          for (let i = 1; i <= pageCount; i++) {
            const linkHTML = `<a href="#" data-page="${i}"${i === pageNumber ? ' class="active"' : ''}>${i}</a>`;
            paginationDiv.insertAdjacentHTML('beforeend', linkHTML);
          }

          // 绑定分页链接点击事件
          paginationDiv.addEventListener('click', event => {
            event.preventDefault();
            const link = event.target.closest('a');
            if (link) {
              const pageNumber = parseInt(link.dataset.page);
              showItems(pageNumber);
              showPagination(pageNumber);
            }
          });
        }

        // 绑定项点击事件
        document.getElementById('items').addEventListener('click', event => {
          const itemDiv = event.target.closest('.item');
          if (itemDiv) {
            const id = itemDiv.dataset.id;
            const item = items.find(item => item.id === id);
            alert(`id: ${item.id}\ntype: ${item.type}\nmsg: ${item.msg}`);
          }
        });

        // 绑定搜索框输入事件
        document.getElementById('search').addEventListener('input', event => {
          const query = event.target.value.trim().toLowerCase();
          const filteredItems = items.filter(item => item.name.toLowerCase().includes(query));
          showItems(1);
          showPagination(1, filteredItems);
        });

        // 初始化展示第一页
        showItems(1);
        showPagination(1);
      });
  </script>
</body>
</html>